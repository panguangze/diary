# 产品重构方案（异地恋记录 + 打卡）

从产品经理视角为 Love Diary 制定的重构方案，目标是把应用聚焦为「异地恋记录 + 打卡」的亲密陪伴工具，提升留存、互动与情绪共鸣。

## 1. 产品定位与目标
- **定位**：为异地情侣提供「每日记录 + 互相打卡 + 情感反馈」的一站式应用。
- **核心目标**：
  1) 提高日活与次日留存（通过轻量打卡与提醒）
  2) 提升互动频次（双人互看、双向点赞/回应）
  3) 形成情感资产（共同时间线、纪念日、相册/语音）
- **关键指标（北极星）**：每日完成「记录或打卡」的情侣对数。

## 2. 用户与场景
- **主要用户**：异地恋情侣（1-3 年为主，时区/作息差异可能存在）
- **核心场景**：
  - 每日心情/事件记录（文字 + 图片/语音）
  - 每日相互打卡（早安/晚安/喝水/作息/健身等）
  - 纪念日提醒与倒计时（相识、恋爱纪念、100/520/999 天）
  - 周/月情绪与习惯趋势回顾
  - 分享「我们的一天」卡片到社交平台

## 3. 价值主张
- **陪伴感**：看到对方的打卡、回应、共同完成 streak。
- **安全感**：数据私密、本地存储，可选云端同步/加密。
- **仪式感**：时间线、纪念日、成就徽章、双人主题皮肤。

## 4. 信息架构（MVP）
- 底部导航（5 个）：
  1) **首页**：今天概览（心情、待办打卡、纪念日提示）
  2) **记录**：文字/图片/语音记录；模板快速输入；情绪选择
  3) **打卡**：习惯列表（双人或单人）、今日完成度、补卡规则
  4) **时间线**：按日展示双方记录、里程碑与照片
  5) **我/设置**：提醒配置、主题、隐私、备份/同步
- 二级入口：
  - 统计：周/月情绪趋势、打卡完成率、连续天数
  - 纪念日：管理/自定义提醒
  - 分享：生成图片卡片（今日心情 + 打卡）

## 5. 关键功能拆解
### 5.1 记录（Diary）
- 快速输入模板（今日三件事、情绪 + 标签）
- 附件：图片（最多 9 张）、语音备忘
- 情绪量表：6 种基础情绪 + 自定义标签
- 互动：对方可点赞、评论、表情回应
- 同步：默认本地，可选「情侣同步」（后续扩展）

### 5.2 打卡（Check-in/Habit）
- 双人/单人模式（同一条习惯可指定「我们一起」或「仅我」）
- 每日提醒（时区兼容）、免打扰时段
- 补卡/漏卡策略（可配：允许补卡 N 天、是否影响连续天数）
- 统计：完成率、连续天数、掉线提醒（对方未打卡推送）
- 互动：对方可为打卡配一句「小确幸」或「鼓励」

### 5.3 纪念日与里程碑
- 自动：恋爱起始日 → 100/520/999 天提醒
- 自定义：生日、线下见面、旅行计划
- 倒计时与提醒时间可配置

### 5.4 时间线 & 回顾
- 按日期聚合：心情、照片、打卡、纪念日
- 周/月回顾卡片（情绪分布 + 打卡完成率）
- 「我们的照片墙」：精选照片 + 一句话

### 5.5 分享与通知
- 分享卡片：今日概览、周报、纪念日贺卡
- 通知：定时提醒、对方完成打卡提醒、留言提醒
- 通知策略：批量合并、避免打扰（夜间静默）

## 6. 体验与交互要点
- 录入减负：一屏完成「情绪 + 文本 + 图片」，模板推荐
- 动画与情绪反馈：打卡成功的微动画/震动；心情色条
- 可用性：48dp 触控区、暗色模式、无障碍描述
- 性能：离线可用，照片压缩与异步加载，避免主线程阻塞

## 7. 数据与埋点（本地为主，可选云端）
- 关键事件：日记录次数、打卡完成、补卡、评论/点赞、分享、通知打开
- 关键指标：DAU、次日留存、7/30 日留存、平均互动次数/日、平均打卡完成率、连续打卡天数分布
- 隐私：默认本地；若开启云同步则使用端到端加密存储（规划）

## 8. 路线图（最小可行迭代）
- **Phase 0（1 周）**：信息架构确认、原型、打卡与记录的 MVP 流程定义
- **Phase 1（2-3 周）**：记录 + 打卡 MVP（单机/本地）；纪念日提醒；周/月统计
- **Phase 2（2 周）**：双人互看、点赞/评论、掉线提醒、分享卡片
- **Phase 3（可选）**：云端同步与端到端加密、跨设备一致性
- **验收标准**：MVP 日活提升、完成率 >60%、次日留存提升、互动次数/情侣/日提升

## 9. 风险与对策
- **时区差异**：所有打卡/提醒使用 UTC + 用户时区存储与渲染
- **打扰与疲劳**：可配置提醒策略；合并通知；夜间静默
- **同步一致性**（若上线云同步）：采用幂等写入、乐观锁/版本号、离线队列重放
- **隐私与安全**：默认本地，云同步需端到端加密；导出/备份受权限保护

## 10. 与现有架构的对齐建议
- 继续沿用现有 **UnifiedCheckIn** 作为统一打卡数据源；扩展字段支持「双人参与者、互动记录」。
- Mood/Diary 使用现有 Room 架构，增加「互动（点赞/评论）」子表或以附件形式存储。
- 通知/提醒使用现有 `NotificationHelper`，增加「双人状态提醒」场景。
- 分享卡片沿用 `ShareHelper`，补充今日概览/周报模板。
- 统计/趋势可基于现有索引与聚合查询，新增「双人完成率、互动次数」指标。

## 11. 成功度量
- DAU、次日留存、7/30 日留存
- 每日平均记录次数、每日平均打卡完成率
- 每日平均互动次数（点赞/评论/回应）
- 连续打卡天数（人均 & 情侣均）
- 通知打开率与分享次数
